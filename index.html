<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Typing Game</title>
  <style>
    body { font-family: monospace; text-align: center; margin-top: 50px; }
    .hidden { display: none; }
    .countdown { font-size: 48px; margin: 20px; }
    .target { font-size: 24px; margin: 20px; }
    .input-box { font-size: 20px; width: 80%; padding: 10px; margin: 10px auto; }
    .score { margin: 20px; font-size: 18px; }
  </style>
</head>
<body>
  <h1>Typing Game - News Edition</h1>
  <div id="countdown" class="countdown hidden"></div>
  <div id="game" class="hidden">
    <div id="target" class="target"></div>
    <input id="input" class="input-box" type="text" autocomplete="off" />
    <div id="mistakes" class="score"></div>
  </div>
  <div id="result" class="hidden">
    <p id="scoreText"></p>
    <button onclick="location.reload()">Restart</button>
  </div>

  <script>
    const headlines = [
      "Senate considers ditching the EV tax credit even earlier than planned",
      "Household energy bills fall but may not go much lower",
      "Guilty plea expected over US student murders"
    ];

    let currentIndex = 0;
    let mistakes = 0;
    let startTime;

    const countdownElement = document.getElementById("countdown");
    const gameElement = document.getElementById("game");
    const inputElement = document.getElementById("input");
    const targetElement = document.getElementById("target");
    const mistakesElement = document.getElementById("mistakes");
    const resultElement = document.getElementById("result");
    const scoreText = document.getElementById("scoreText");

    function showHeadline() {
      targetElement.textContent = headlines[currentIndex];
      inputElement.value = "";
      inputElement.focus();
    }

    function startGame() {
      countdown(3);
    }

    function countdown(seconds) {
      countdownElement.textContent = seconds;
      countdownElement.classList.remove("hidden");
      if (seconds > 0) {
        setTimeout(() => countdown(seconds - 1), 1000);
      } else {
        countdownElement.classList.add("hidden");
        gameElement.classList.remove("hidden");
        startTime = new Date();
        showHeadline();
      }
    }

    inputElement.addEventListener("input", () => {
      const currentText = inputElement.value;
      const targetText = headlines[currentIndex];

      if (targetText.startsWith(currentText)) {
        inputElement.style.color = "black";
      } else {
        inputElement.style.color = "red";
        mistakes++;
      }

      if (currentText === targetText) {
        currentIndex++;
        if (currentIndex >= headlines.length) {
          endGame();
        } else {
          showHeadline();
        }
      }

      mistakesElement.textContent = `Mistakes: ${mistakes}`;
    });

    function endGame() {
      gameElement.classList.add("hidden");
      const timeTaken = (new Date() - startTime) / 1000;
      const score = Math.max(0, (headlines.join('').length - mistakes * 2));
      scoreText.textContent = `Score: ${score}\nMistakes: ${mistakes}\nTime: ${timeTaken.toFixed(1)} seconds`;
      resultElement.classList.remove("hidden");
    }

    // Start game on load
    window.onload = startGame;
  </script>
</body>
</html>
